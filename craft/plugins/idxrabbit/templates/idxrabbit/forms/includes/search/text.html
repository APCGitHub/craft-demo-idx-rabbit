{% spaceless %}

{% set key = random() %}

{% if field is defined and field %}
	{% if field starts with 'filter[' %}
		{# coming form parent #}

		{% set nameKey = field %}
	{% else %}
		{# called directly #}

		{% set nameKey = "filter[" ~ field ~ "][" ~ key ~ "]" %}
	{% endif %}

	{% if type is defined and type %}
		<input type="hidden" name="{{ nameKey }}[type]" value="{{ type }}">
	{% endif %}

	{% if modifier is defined and modifier %}
		<input type="hidden" name="{{ nameKey }}[modifier]" value="{{modifier}}">
	{% endif %}

	{% if clause is defined and clause == 'or' %}
		<input type="hidden" name="{{ nameKey }}[clause]" value="or">
	{% endif %}

	<input type="text"
		{% if style is defined and style %} style="{{ style }}"{% endif %}
		{% if class is defined and class %} class="{{ class }}"{% endif %}
		{% if id is defined and id %} id="{{ id }}"{% endif %}
		{% if size is defined %} size="{{ size }}"{% endif %}
		name="{{ nameKey }}[value]"
		{% if value is defined %} value="{{ value }}"{% endif %}
		{% if maxlength is defined and maxlength %} maxlength="{{ maxlength }}"{% endif %}
		{% if disabled is defined and disabled %} disabled {% endif %}
		{% if readonly is defined and readonly %} readonly {% endif %}
		{% if title is defined %} title="{{ title }}"{% endif %}
		{% if placeholder is defined %} placeholder="{{ placeholder }}"{% endif %}
		{% if attrs is defined and attrs|length %}
			{% for attr in attrs %}
				{{ attr.name }}="{{ attr.value }}"
			{% endfor %}
		{% endif %}>
{% elseif fields is defined and fields|length %}
	{# called directly #}

	{% set nameKey = "filter[IDX_MultiField][" ~ key ~ "]" %}
	{% set fields = fields | join(',') %}

	<input type="hidden" name="{{ nameKey }}[fields]" value="{{fields}}">

	{% if type is defined and type %}
		<input type="hidden" name="{{ nameKey }}[type]" value="{{ type }}">
	{% endif %}

	{% if modifier is defined and modifier %}
		<input type="hidden" name="{{ nameKey }}[modifier]" value="{{modifier}}">
	{% endif %}

	{% if clause is defined and clause == 'or' %}
		<input type="hidden" name="{{ nameKey }}[clause]" value="or">
	{% endif %}

	<input type="text"
		{% if style is defined and style %} style="{{ style }}"{% endif %}
		{% if id is defined and id %} id="{{ id }}"{% endif %}
		{% if class is defined and class %} class="{{ class }}"{% endif %}
		{% if size is defined %} size="{{ size }}"{% endif %}
		name="{{ nameKey }}[value]"
		{% if value is defined %} value="{{ value }}"{% endif %}
		{% if maxlength is defined and maxlength %} maxlength="{{ maxlength }}"{% endif %}
		{% if disabled is defined and disabled %} disabled {% endif %}
		{% if readonly is defined and readonly %} readonly {% endif %}
		{% if title is defined %} title="{{ title }}"{% endif %}
		{% if placeholder is defined %} placeholder="{{ placeholder }}"{% endif %}
		{% if attrs is defined and attrs|length %}
			{% for attr in attrs %}
				{{ attr.name }}="{{ attr.value }}"
			{% endfor %}
		{% endif %}>
{% else %}
	<p>Missing required {field/fields} param</p>
{% endif %}

{% endspaceless %}