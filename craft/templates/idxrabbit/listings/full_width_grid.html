{% set results = listings({
	'$filter': (where is defined) ? where : '', 
	'$top': (limit is defined) ? limit : 100,
	'$skip': (page is defined) ? (page-1)*limit : 0,
	'$orderby': (orderBy is defined) ? orderBy : ''
}) %}

{% if results['errors'] is defined and results.errors %}
	<div class="card">
		<div class="card__header">
			<h1>Uh oh</h1>
			{% for error in results.errors %}
				{% if error['message'] is defined %}
					<small>{{error.message}}</small>
				{% else %}
					<small>An error occurred</small>
				{% endif %}
			{% endfor %}
		</div>
	</div>
{% else %}
	{% set listings = results.data %}
	
	{% embed "listings/partials/grid.html" with {'listings': listings} only %}
		{% block emptyListings %}
			<div class="card">
				<div class="card__header">
					<h1>No Listings</h1>
				</div>
			</div>
		{% endblock %}
	{% endembed %}
{% endif %}
